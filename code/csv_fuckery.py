import re
import os
import csv
name_to_fold = {'3hsc': 59, '2cas': 26, '1pga': 72, '2dkb': 61, '1ckaa': 31, '1hmpa': 60, '1csp': 32, '2gps': 110, '2cmd2': 89, '2cmd1': 51, '1nal1': 46, '2hipa': 121, '1xnb': 30, '1mmd_2': 54, '2snv': 35, '1esl_2': 110, '1fmca': 51, '1cbs': 39, '1fna': 20, '2hnte': 35, '1hip': 121, '1qba_3': 46, '1scub1': 48, '3mona': 76, '1hpm_2': 59, '1scub2': 48, '1neu': 20, '1arb': 35, '1zxq_2': 20, '1gbs': 102, '1pil': 87, '1etpa2': 3, '1dpi': 104, '1esc': 48, '2hpea': 36, '1sto': 60, '1kit_1': 30, '1kit_2': 30, '1ars': 61, '1dhpa': 46, '2pde': 5, '1put': 72, '1pda2': 81, '1pda1': 69, '1bnb': 113, '2drpa1': 122, '1fod4': 26, '1ifa': 9, '1udpa': 51, '2sn3': 110, '1nnt': 69, '2scmc': 11, '1hnf': 20, '4rhv4': 127, '1htrp': 36, '4rhv1': 26, '4rhv3': 26, '4rhv2': 26, '1tap': 112, '1gmpa': 71, '1egf': 110, '1pii_2': 46, '1clh': 41, '1eria': 58, '2reb1': 54, '1ret': 4, '1oxy1': 20, '1res': 4, '1ilr1': 33, '1lgaa': 16, '1ah9': 32, '2mtac': 3, '1yvei2': 51, '2tmvp': 7, '1urna': 87, '1lcl': 30, '3gapb1': 45, '1rec': 11, '3gapb2': 4, '2hmqa': 7, '1tnn': 20, '1klo_2': 110, '1vtmp': 7, '1achb': 105, '2gsta1': 57, '6fabl': 20, '1bara': 33, '2hft_2': 20, '2hft_1': 20, '1plq1': 95, '1dfna': 113, '1bet': 118, '1gky': 54, '1yhb': 32, '1eal': 39, '1nsj': 46, '1igd': 72, '1pnt': 56, '1srp1': 86, '1eit': 110, '1eaf': 55, '1pcrm': 108, '8i1b': 33, '1fc2d': 20, '1nrd1': 23, '1efg2': 34, '1efg3': 82, '1pnh': 110, '2tmda1': 46, '2tmda2': 47, '1isca1': 2, '1frpa': 103, '1inp': 103, '1ecea': 46, '1vaab': 20, '1rgd': 124, '1sro': 32, '1hdp': 4, '2baa': 102, '1gur': 110, '1gca': 69, '1hura': 54, '1orda1': 48, '1pkp2': 82, '1pkp1': 81, '1llda2': 89, '1mmob': 8, '1llda1': 51, '1dar_4': 87, '1mmod': 8, '2rspb': 36, '1ppn': 100, '1regx': 87, '1hms': 39, '1pfia': 19, '1ilk': 9, '1cyx': 23, '1prha2': 110, '1ppa': 18, '1skz_1': 110, '1nar': 46, '3mdda1': 7, '2hpda': 17, '1wiu': 20, '1ggta1': 20, '1scmb': 11, '1hava': 35, '1cpo_1': 11, '1pkn1': 46, '1fcdc2': 3, '1fcdc1': 3, '1vfba': 20, '1fca': 87, '1zxq_1': 20, '1olba': 69, '2pac': 3, '1alla': 1, '2kauc2': 46, '2trxa': 57, '1nhp_2': 47, '2int': 9, '1igs': 46, '1pxtb1': 70, '1igp': 32, '1hbp': 39, '1glqa2': 57, '2phy': 39, '1ebpa': 20, '7icd': 65, '2ayh': 30, '1qba_1': 20, '1dmc': 126, '1sty': 32, '1hcna': 118, '1glcg1': 59, '1glcg2': 59, '1dvh': 3, '1stma': 26, '9wga4': 109, '1cdcb': 20, '1hcnb': 118, '9wga1': 109, '9wga3': 109, '9wga2': 109, '1hvq': 46, '1tlfa': 69, '1kfd_1': 59, '1ris': 87, '1rip': 32, '1pmy': 23, '1scy': 110, '2pgd_2': 51, '1mrj': 90, '1cdg_4': 46, '1qora1': 43, '1qora2': 51, '1cdg_1': 20, '4cpai': 110, '1aoza1': 23, '1aoza2': 23, '1bbre': 35, '1pba': 87, '1dih_1': 51, '1cpn': 30, '1ihwa': 31, '1lla_2': 20, '1cpt': 17, '1hrnb': 36, '1gdha1': 48, '1pbp': 69, '1gdha2': 51, '1rro': 11, '1mup': 39, '1bip': 14, '1ldb_1': 51, '2bopa': 87, '1pyda1': 53, '1pyda3': 52, '1pyda2': 53, '1bgla1': 20, '1kcw_4': 23, '1bgla2': 20, '1cfb_1': 20, '1bsaa': 71, '1gata': 124, '1mli': 87, '1gnwa2': 57, '3hhrb2': 20, '3hhrb1': 20, '4blma': 101, '2mnr1': 85, '2mnr2': 46, '1gmfa': 9, '1vjw': 87, '1ghr': 46, '1prcl': 108, '1ash': 1, '1bmda2': 89, '1lpe': 7, '1hmca': 9, '1ldg_1': 51, '1hmcb': 9, '1vaoa1': 87, '1prtb1': 32, '1ppi_2': 46, '1lpt': 14, '1xel': 51, '1asu': 59, '1tpfa': 46, '2pcda': 22, '1cbp': 23, '1ezm1': 86, '1beba': 39, '1trka2': 53, '1trka1': 53, '2at2a': 66, '1ptx': 110, '1ofga1': 51, '2pcdm': 22, '1hdca': 51, '1pnra2': 69, '1pta': 46, '1cbg': 46, '1cbh': 110, '1msec1': 4, '1vcaa1': 20, '1vcaa2': 20, '1msec2': 4, '1mek': 57, '2er7e': 36, '1nhkl': 87, '1hula': 9, '3il8': 77, '1cuk_3': 32, '1cid': 20, '1cgt3': 46, '1agja': 35, '1xgsa1': 4, '3cd4_1': 20, '3cd4_2': 20, '1lid': 39, '1jmca1': 32, '1epab': 39, '1rfba': 9, '1wht.1': 62, '351c': 3, '2crd': 110, '1bhb': 128, '2cro': 10, '2cdv': 120, '1mjc': 32, '1osa': 11, '2lhb': 1, '1mrb': 126, '1lfb': 4, '4znf': 123, '1erh': 111, '1i1b': 33, '1aplc': 4, '1hucb': 100, '1ggta2': 20, '1ggta3': 20, '1adr': 10, '3lada3': 84, '3lada2': 47, '3lada1': 47, '1rmi': 9, '1reqa2': 48, '1bgu': 68, '1aoza3': 23, '1bgla5': 46, '1up1_1': 87, '1dlha2': 20, '1xer': 87, '1dlha1': 20, '1cec': 46, '1wgta4': 110, '3cla': 55, '1bpb': 104, '1dpra1': 4, '1fbaa': 46, '2trcp': 57, '1raab1': 87, '1oma': 110, '1sgc': 35, '2fxb': 87, '1ctm1': 21, '1pud': 46, '1paa': 123, '1omp': 69, '1hrda1': 51, '1cto': 20, '1bgeb': 9, '1edt': 46, '1coy_1': 47, '1srya2': 96, '4sgbi': 116, '1srya1': 2, '1rnl_2': 48, '1hcd': 33, '1hce': 33, '2bpa2': 26, '2bpa3': 127, '2bpa1': 26, '1qapa1': 46, '2xis': 46, '2bds': 113, '1alo_2': 72, '1epta': 35, '1bgc': 9, '2tpra1': 47, '2tpra3': 84, '2tpra2': 47, '1asza1': 32, '1asza2': 96, '2sga': 35, '1ckma1': 32, '1pfsa': 32, '1ksr': 20, '1dhma': 87, '1cpq': 7, '1hdgo1': 51, '5p21': 54, '1srga': 40, '1hyha1': 51, '1tada2': 54, '1was': 7, '1reqb2': 48, '1reqb1': 46, '2hmza': 7, '2pia_3': 72, '1hrti': 119, '1bhga3': 46, '1bhga1': 20, '1etd': 4, '1rcf': 48, '1ak5': 46, '1rcb': 9, '1edg': 46, '2mev3': 26, '2mev2': 26, '2mev1': 26, '1opc': 4, '1lea': 4, '1leb': 4, '1vaaa2': 20, '1vaaa1': 80, '1lpba1': 110, '1lpba2': 110, '4tgf': 114, '1kcw_1': 23, '1csei': 75, '1dpga1': 51, '1aaj': 23, '1kcw_3': 23, '2fx2': 48, '1tpla': 61, '1bmv1': 26, '1bco_2': 59, '1kcw_2': 23, '1luca': 46, '1lucb': 46, '1epba': 39, '1kcw_5': 23, '1hsla': 69, '1nrca': 87, '1cid_1': 20, '1cid_2': 20, '2stv': 26, '1tiu': 20, '1drf': 64, '1ivd': 42, '1kcw_6': 23, '1wgta1': 110, '1wgta2': 110, '1afi': 87, '1tib': 62, '1pht': 31, '1tie': 33, '1tif': 72, '1hre': 110, '3aaha': 42, '2sblb1': 28, '1huw': 9, '2bbva': 26, '5ruba1': 46, '2bbvc': 26, '1bcfa': 8, '1fwp': 87, '1sfta2': 46, '2scpa': 11, '5ruba2': 87, '1etb1': 22, '1pyaa': 79, '3ulla': 32, '1gpc': 32, '1shfa': 31, '1vtk': 54, '1pdnc': 4, '1etpa1': 3, '2glt2': 78, '1pspa2': 117, '8fabb': 20, '3chy': 48, '1ldm_1': 51, '1vie': 31, '1yaia': 20, '1yrnb': 4, '2ptl': 72, '1bmfd3': 54, '1gsq1': 57, '1gsq2': 13, '2blta': 101, '1gesa1': 47, '3rub2': 46, '3rub1': 87, '1sra': 11, '2hft1': 20, '5cytr': 3, '1tiid': 32, '1eny': 51, '4enl1': 46, '4enl2': 85, '3rubl1': 46, '1tde_1': 47, '5znf': 123, '1stfi': 76, '1tde_2': 47, '1aofa1': 3, '1tahb': 62, '1pse': 31, '1hlb': 1, '1bmv2': 26, '3ebx': 111, '1dpi1': 59, '2sil': 42, '1mdc': 39, '1huma': 77, '1scua1': 51, '1scua2': 48, '1whta': 62, '1rhoa': 20, '1whtb': 62, '1dhr': 51, '1bbha': 7, '1c53': 3, '1dhx': 26, '2cy3': 120, '2lbp': 69, '1mina': 67, '1minb': 67, '2hcgb': 114, '1tlk': 20, '1bmda1': 51, '2liv': 69, '1srra': 48, '1guab': 72, '2ak3b': 54, '2fcr': 48, '1hleb': 105, '1hlea': 105, '1lac': 24, '1lyla1': 32, '1lgr_1': 72, '1jli': 9, '1aba': 57, '1clc_2': 20, '8abp': 69, '1ebha1': 46, '1apme': 99, '1dlhb': 20, '1nhp_1': 47, '1lmb3': 10, '1bct': 128, '1amp': 63, '1hrha': 59, '1lh1': 1, '1prta': 91, '1prtf': 32, '1geo_2': 87, '1prtd': 32, '1riba': 8, '1baba': 1, '1dosa': 46, '1grj1': 2, '1grj2': 83, '1ezm2': 15, '2ebn': 46, '1jer': 23, '1vmoa': 44, '2nada2': 48, '1vhia': 87, '2nada1': 51, '2naca2': 51, '1eca': 1, '1gof_1': 20, '1plc': 23, '1ab2': 93, '1spha': 94, '1cpca': 1, '1cpcb': 1, '1reqa1': 46, '1bgh': 32, '1pho': 107, '1ukz': 54, '3rubl2': 87, '1pls': 38, '1irk': 99, '1esfa1': 32, '1rvaa': 58, '1pyp': 32, '1cd1a1': 20, '1eng': 37, '1enh': 4, '1hbq': 39, '1hjra': 59, '1iva': 110, '1cus': 48, '1cur': 23, '1hbg': 1, '1wgta3': 110, '1sva1': 26, '1dora': 46, '1mat': 88, '1knt': 112, '1fnc1': 34, '2mysb': 11, '1fnc2': 49, '1cc5': 3, '1bdma1': 51, '1apq': 110, '1amy_2': 46, '1flp': 1, '1esfa2': 72, '1gal_1': 47, '1tme1': 26, '1svr': 97, '1glag1': 59, '1urk2': 115, '4gcr1': 27, '1hks': 4, '1babb': 1, '1chma1': 59, '1chma2': 88, '1fcda1': 47, '1aps': 87, '1fcda3': 84, '1fcda2': 47, '2hnq': 56, '3pte': 101, '1pbe_1': 47, '1hfc': 86, '4sbva': 26, '1apa': 90, '1xys': 46, '1cska': 31, '1pspa1': 117, '5rub1': 87, '1nsca': 42, '1psda1': 48, '5rub2': 46, '1exg': 21, '3cd4': 20, '1ccr': 3, '1ctn3': 83, '1ctn2': 46, '1ctn1': 20, '4fxn': 48, '1tin': 75, '2chr_1': 46, '1ccf': 114, '1gsea2': 57, '2mnr_1': 46, '1ybva': 51, '3inkc': 9, '1dts': 54, '2fgf': 33, '3tgl': 62, '1ang': 73, '7pti': 112, '1hc2_2': 20, '1cgpa1': 4, '1pii_1': 46, '4icb': 11, '3sdha': 1, '1byb': 46, '1ltsd': 32, '1ltsa': 91, '1psda3': 87, '1ltsc': 91, '2mcm': 20, '1gph1': 60, '1gym': 46, '1jdc_2': 46, '1gnd_1': 47, '2ncm': 20, '1hsta': 4, '1thg': 62, '1pkt': 31, '2mhu': 126, '1bbl': 5, '1aky': 54, '1dik_1': 46, '1scs': 30, '1gd1o1': 51, '1dxy_1': 48, '1dyna': 38, '1dxy_2': 51, '1mypc': 16, '1mypa': 16, '1prs1': 27, '1itha': 1, '1flei': 110, '2plea': 93, '1tnm': 20, '1wapb': 45, '1ego': 57, '1onc': 73, '1djxa1': 11, '1djxa3': 46, '2rn2': 59, '1fxra': 87, '2liga': 7, '1leha1': 51, '1isua': 121, '1psda2': 51, '1chra2': 46, '1chra1': 85, '1shg': 31, '2aaa_2': 46, '1fha': 8, '1rtp1': 11, '1erp': 6, '1nfp': 46, '1scma': 19, '1gof1': 20, '1gof2': 42, '1gof3': 29, '1ica': 110, '1erd': 6, '1pxtb2': 70, '1sso': 31, '1jmca2': 32, '1cyi': 3, '1deka': 54, '1erl': 6, '1pvua': 58, '1nipa': 54, '1asya1': 32, '1lpbb1': 62, '2pia1': 34, '2pia3': 72, '2pia2': 49, '1glag2': 59, '2hbg': 1, '1tsk': 110, '1noa': 20, '2btfp': 98, '1hpla2': 62, '1clc1': 20, '1obpa': 39, '1lpbb2': 28, '2hhma': 103, '1efg1': 54, '8rxna': 125, '1tph1': 46, '1ctaa': 11, '2btfa2': 59, '2btfa1': 59, '2por': 107, '1gtra1': 50, '2gdm': 1, '1fas': 111, '1cgo': 7, '1thta': 62, '1gsra1': 57, '1din': 62, '1cola': 106, '1ncia': 20, '2sas': 11, '2sh1': 113, '2tgf': 110, '1bia_2': 31, '2ctc': 63, '1tca': 62, '1ucwa': 46, '2tgi': 118, '1se4_1': 32, '1tssa1': 32, '1tssa2': 72, '1se4_2': 72, '1wba': 33, '1adea': 54, '3hhr1': 20, '3hhr2': 20, '2atcb1': 87, '2atcb2': 125, '1spbp': 87, '7rsa': 73, '2naca1': 48, '1hlpa1': 51, '1pii1': 46, '2cnd1': 34, '2cnd2': 49, '1hcgb': 110, '1mla_2': 87, '1smva': 26, '2hsp': 31, '1eft1': 54, '1lobd': 30, '1eft2': 34, '2prd': 32, '1pou': 10, '1octc1': 4, '1gks': 3, '1mpp': 36, '1cwpa': 26, '6taa1': 46, '1efg4': 87, '1yasa': 62, '6taa2': 25, '1poc': 18, '1poa': 18, '1ctn_1': 20, '1fjla': 4, '1poh': 94, '1ntr': 48, '2cbp': 23, '1har': 104, '1wsya': 46, '1bbpa': 39, '1crl': 62, '2azaa': 23, '1cewi': 76, '2ila': 33, '1pyab': 79, '256ba': 7, '2cbh': 110, '1rpa': 60, '1vil': 97, '1mspa': 20, '1pkya2': 46, '2ohxa1': 43, '2ohxa2': 51, '1fow': 4, '2pgd1': 51, '2kaib': 35, '1mbd': 1, '1slaa': 30, '1mba': 1, '1ab8a': 87, '2alp': 35, '1frub': 20, '1pbe1': 47, '1pbe2': 74, '1broa': 62, '1buca1': 7, '1sema': 31, '2pola2': 95, '2pola3': 95, '1fds': 51, '2pola1': 95, '1xyza': 46, '1slta': 30, '1lena': 30, '3sgbi': 116, '1cmca': 12, '4kbpa1': 20, '1cnt1': 9, '9rnt': 71, '1dar_2': 54, '1avda': 40, '1ghsa': 46, '1lki': 9, '1amg2': 25, '1amg1': 46, '2yhx_1': 59, '2yhx_2': 59, '2cp4': 17, '1ifc': 39, '1sxl': 87, '1keva2': 51, '1fd2': 87, '1bty': 35, '1svb_1': 20, '1mdka': 57, '1iae': 86, '1iag': 86, '1xsoa': 20, '1tfi': 125, '1caub': 45, '1caua': 45, '1taha': 62, '3egf': 114, '1lfo': 39, '1skz_2': 110, '1cd8': 20, '1bia_1': 4, '1cpo_2': 11, '2mge': 1, '2cpl': 41, '1ktx': 110, '1esl1': 92, '1amy1': 46, '1ppbl': 35, '1amy2': 25, '1ack': 62, '1hcra': 4, '1hsq': 31, '1kte': 57, '1dsba2': 57, '1cyda': 51, '1l92': 102, '1yptb': 56, '1klo_1': 110, '1pea': 69, '1bbt1': 26, '1bbt2': 26, '1bbt3': 26, '1saca': 30, '3dfr': 64, '2cmd_1': 51, '1abrb2': 33, '1rsy': 20, '1abrb1': 33, '1eft_3': 54, '8tlne2': 15, '8tlne1': 86, '2pf11': 115, '4xiaa': 46, '1ctn_2': 46, '5nul': 48, '1lvl_2': 47, '2ts11': 50, '1lvl_1': 47, '1ayaa': 93, '1bova': 32, '1tgsi': 116, '2acr': 46, '1frd': 72, '3dpa1': 20, '1atna1': 59, '1bmfa3': 54, '1occb1': 23, '1gtma1': 51, '1cxa': 3, '2acg': 98, '1up1_2': 87, '1ede': 62, '1pcl': 45, '1noya': 59, '1cfb1': 20, '1npk': 87, '1emo_1': 110, '1emo_2': 110, '1hex': 65, '1mmd_1': 31, '1tabi': 110, '1dapa1': 51, '2tbva': 26, '1rtm1': 92, '1igna1': 4, '1igna2': 4, '1gesa2': 47, '1ddt1': 91, '1ddt2': 106, '1ddt3': 21, '1bmta2': 48, '1hpm_1': 59, '2ihl': 102, '1sfe_1': 4, '1sfe_2': 59, '2hts': 4, '2bbkh': 42, '1gox': 46, '1tcob': 11, '1htp': 24, '1tpn': 115, '1dec': 119, '4dfra': 64, '1yrna': 4, '8atca2': 66, '8atca1': 66, '2ztaa': 19, '1gp1a': 57, '1cela': 30, '1fkf': 83, '1croa': 10, '1chl': 110, '2dri': 69, '1cgt4': 25, '2ccya': 7, '1cgt2': 22, '3cox1': 47, '3cox2': 74, '1cgt1': 20, '1mylb': 12, '1pvc3': 26, '1pvc2': 26, '1pvc1': 26, '2u1a': 87, '1trb1': 47, '1umua': 31, '1ten': 20, '1dlc1': 106, '1dlc3': 29, '1dlc2': 44, '1gsra2': 13, '1ads': 46, '1gpb': 68, '2gsta2': 57, '1poxa3': 52, '1poxa2': 53, '1poxa1': 53, '1gpr': 24, '1gps': 110, '1add': 46, '1fapb': 7, '1oyb': 46, '1oya': 46, '1geo_1': 87, '1csga': 9, '1prtc2': 32, '1ppi2': 25, '1ppi1': 46, '1prtc1': 92, '1txm': 110, '1aoy': 4, '1klo_3': 110, '1pdga': 118, '1bw4': 37, '1ubi': 72, '1atna2': 59, '1gal1': 47, '1gal2': 74, '7ccp': 16, '2reb_1': 54, '1qrda': 48, '1itg': 59, '1cdta': 111, '1kab': 32, '1aiza': 23, '1sbp': 69, '1puee': 4, '1tadc2': 54, '1bam': 58}


for fil in os.listdir('../data/train_data'):
	with open('../data/train_data/' + fil, 'rb') as f:
		data = f.readlines()
		print data[0]

		for i in range(len(data)):
			data[i] = re.sub( '\s+', ',', data[i].lstrip().strip()) + '\n'
			token = data[i].split(',')
			data[i] = data[i].strip() + "," + str(name_to_fold[token[-1].strip()]) + "\n"

		with open('../data/corrected_train_data/' + fil[:-4] + ".csv" , 'wb') as g:
			g.writelines(data)
for fil in os.listdir('../data/test_data'):
	print fil [:-4]
	with open('../data/test_data/' + fil, 'rb') as f:
		data = f.readlines()
		print data[0]

		for i in range(len(data)):
			data[i] = re.sub( '\s+', ',', data[i].lstrip().strip()) + '\n'
			token = data[i].split(',')
			data[i] = data[i].strip() + "," + str(name_to_fold[token[-1].strip()]) + "\n"

		with open('../data/corrected_test_data/' + fil[:-4] + ".csv" , 'wb') as g:
			g.writelines(data)

		# csvwrite = csv.writer(g, delimiter=',')
		
		# for row in data:
		# 	print row
		# 	csvwrite.writerow(row)